<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intro to GIS and Spatial Analysis</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/private-test" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="spatial-interpolation.html">
<link rel="next" href="coordinate-systems-in-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.6/htmlwidgets.js"></script>
<link href="libs/leaflet-0.7.3/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.3/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/leaflet-binding-1.0.1/leaflet.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a><ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>I Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="feature-representation.html"><a href="feature-representation.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a><ul>
<li class="chapter" data-level="2.1" data-path="feature-representation.html"><a href="feature-representation.html#vector-vs.raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a><ul>
<li class="chapter" data-level="2.1.1" data-path="feature-representation.html"><a href="feature-representation.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="feature-representation.html"><a href="feature-representation.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="feature-representation.html"><a href="feature-representation.html#object-vs.field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a><ul>
<li class="chapter" data-level="2.2.1" data-path="feature-representation.html"><a href="feature-representation.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="feature-representation.html"><a href="feature-representation.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="feature-representation.html"><a href="feature-representation.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="feature-representation.html"><a href="feature-representation.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a><ul>
<li class="chapter" data-level="2.4.1" data-path="feature-representation.html"><a href="feature-representation.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="feature-representation.html"><a href="feature-representation.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a><ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a><ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a><ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a><ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a><ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>5</b> Pitfalls to avoid</a><ul>
<li class="chapter" data-level="5.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>5.1</b> Representing Count</a></li>
<li class="chapter" data-level="5.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>5.2</b> MAUP</a></li>
<li class="chapter" data-level="5.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>5.4</b> Mapping rates</a></li>
<li class="chapter" data-level="5.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>5.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>6</b> Good Map Making Tips</a><ul>
<li class="chapter" data-level="6.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>6.1</b> Elements of a map</a></li>
<li class="chapter" data-level="6.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>6.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="6.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>6.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html"><i class="fa fa-check"></i><b>7</b> Uncertainty in Census Data</a><ul>
<li class="chapter" data-level="7.1" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#mapping-uncertainty"><i class="fa fa-check"></i><b>7.2</b> Mapping uncertainty</a></li>
<li class="chapter" data-level="7.3" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#class-comparison-maps"><i class="fa fa-check"></i><b>7.4</b> Class comparison maps</a></li>
<li class="chapter" data-level="7.5" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>7.5</b> Problem when performing bivariate analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a><ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a><ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="coordinate-systems.html"><a href="coordinate-systems.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="coordinate-systems.html"><a href="coordinate-systems.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a><ul>
<li class="chapter" data-level="9.2.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="map-algebra.html"><a href="map-algebra.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a><ul>
<li class="chapter" data-level="10.1" data-path="map-algebra.html"><a href="map-algebra.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="map-algebra.html"><a href="map-algebra.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="map-algebra.html"><a href="map-algebra.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="map-algebra.html"><a href="map-algebra.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="map-algebra.html"><a href="map-algebra.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a><ul>
<li class="chapter" data-level="10.5.1" data-path="map-algebra.html"><a href="map-algebra.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="map-algebra.html"><a href="map-algebra.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="map-algebra.html"><a href="map-algebra.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="map-algebra.html"><a href="map-algebra.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a><ul>
<li class="chapter" data-level="11.3.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a><ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-a-covariate-effect"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s I</a><ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s I</a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s I at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html"><i class="fa fa-check"></i>Data Manipulation in R</a><ul>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-vector-files"><i class="fa fa-check"></i>Reading vector files</a><ul>
<li class="chapter" data-level="14.2.3" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-a-shapefile-with-rgdal"><i class="fa fa-check"></i><b>14.2.3</b> Reading a shapefile with <code>rgdal</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-a-shapefile-with-maptools"><i class="fa fa-check"></i><b>14.2.4</b> Reading a shapefile with <code class="unnumbered">maptools</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-a-geopackage"><i class="fa fa-check"></i><b>14.2.5</b> Reading a GeoPackage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-gis-raster-files"><i class="fa fa-check"></i>Reading GIS raster files</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#dissecting-the-file-summary"><i class="fa fa-check"></i>Dissecting the file summary</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#mapping-spatial-data"><i class="fa fa-check"></i>Mapping spatial data</a><ul>
<li class="chapter" data-level="14.2.6" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#mapping-with-spplot"><i class="fa fa-check"></i><b>14.2.6</b> Mapping with <code class="unnumbered">spplot</code></a></li>
<li class="chapter" data-level="14.2.7" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#mapping-with-tmap"><i class="fa fa-check"></i><b>14.2.7</b> Mapping with <code class="unnumbered">tmap</code></a></li>
<li class="chapter" data-level="14.2.8" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#mapping-rasters-with-tmap"><i class="fa fa-check"></i><b>14.2.8</b> Mapping rasters with <code class="unnumbered">tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#joining-tables-to-spatial-features"><i class="fa fa-check"></i>Joining tables to spatial features</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#converting-xy-data-to-point-objects"><i class="fa fa-check"></i>Converting XY data to point objects</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#geocoding-street-addresses"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-shapefile"><i class="fa fa-check"></i>Exporting to a shapefile</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-geopackage"><i class="fa fa-check"></i>Exporting to a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-raster-file-format"><i class="fa fa-check"></i>Exporting to a raster file format</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i>Coordinate Systems in R</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-coordinate-syntax"><i class="fa fa-check"></i>Understanding the coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#modifying-coordinate-systems"><i class="fa fa-check"></i>Modifying coordinate systems</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#example-of-failed-transformations"><i class="fa fa-check"></i>Example of failed transformations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i>Vector operations in R</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolve-by-contiguous-shape"><i class="fa fa-check"></i>Dissolve by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolve-by-attribute"><i class="fa fa-check"></i>Dissolve by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#calculate-area"><i class="fa fa-check"></i>Calculate area</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#subsetting"><i class="fa fa-check"></i>Subsetting</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting"><i class="fa fa-check"></i>Intersecting</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-polygons-with-line-and-point-objects"><i class="fa fa-check"></i>Intersecting polygons with line and point objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#unioning"><i class="fa fa-check"></i>Unioning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i>Raster operations in R</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#local-operations-and-functions-1"><i class="fa fa-check"></i>Local operations and functions</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#unary-operations-and-functions-applied-to-single-raster"><i class="fa fa-check"></i>Unary operations and functions (applied to single raster)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#binary-operations-and-functions-where-two-layers-are-used"><i class="fa fa-check"></i>Binary operations and functions (where two layers are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#focal-operations-and-functions-1"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#zonal-operations-and-functions-1"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#global-operations-and-functions-1"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#computing-cumulative-distances"><i class="fa fa-check"></i>Computing cumulative distances</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#working-example"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i>Point pattern analysis in R</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#density-based-analysis-1"><i class="fa fa-check"></i>Density based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-1"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-on-a-tesselated-surface"><i class="fa fa-check"></i>Quadrat density on a tesselated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-raster"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-adjusted-for-covariate-1"><i class="fa fa-check"></i>Kernel Density Adjusted for Covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#modeling-intensity-as-a-function-of-a-covariate-1"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#distance-based-analysis-1"><i class="fa fa-check"></i>Distance based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#average-nearest-neighbor-analysis"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#k-and-l-functions-1"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#the-pair-correlation-function-g-1"><i class="fa fa-check"></i>The Pair Correlation Function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#hypothesis-tests"><i class="fa fa-check"></i>Hypothesis tests</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-clustering"><i class="fa fa-check"></i>Test for clustering</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#computing-a-pseudo-p-value"><i class="fa fa-check"></i>Computing a pseudo p-value</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#testing-for-a-covariate-effect-1"><i class="fa fa-check"></i>Testing for a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i>Spatial Autocorrelation in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#define-neighboring-polygons"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-the-morans-i-statistic-the-hard-way"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-the-morans-i-statistic-the-easy-way"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#morans-i-as-a-function-of-a-distance-band"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i>Interpolation in R</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li><a href="interpolation-in-r.html#st-order-polynomial-fit">1<sup>st</sup> order polynomial fit</a></li>
<li><a href="interpolation-in-r.html#nd-order-polynomial">2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-map"><i class="fa fa-check"></i>Generate the variance map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i>Mapping rates in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#raw-rates"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#standardized-mortality-ratios-relative-risk."><i class="fa fa-check"></i>Standardized mortality ratios (relative risk).</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#dykes-and-unwins-chi-square-statistic"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#unstable-ratios"><i class="fa fa-check"></i>Unstable ratios</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#global-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#local-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulation-in-r" class="section level1 unnumbered">
<h1>Data Manipulation in R</h1>
<div id="reading-vector-files" class="section level2 unnumbered">
<h2>Reading vector files</h2>
<p>First, we’ll load sample spatial data files into the current working directory (you might want to create a temporary folder for this exercise and set it as the working directory via the <strong>Session &gt;&gt; Set Working Directory &gt;&gt; Choose Directory</strong> pull-down menu from the RStudio interface).</p>
<p>The following chunk will download and unzip a zipped shapefile into the current working directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">tempfile</span>()
<span class="kw">download.file</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/Income_schooling.zip&quot;</span>, <span class="dt">destfile =</span> tmp)
<span class="kw">unzip</span>(tmp, <span class="dt">exdir =</span> <span class="st">&quot;.&quot;</span>)</code></pre></div>
<p>The first line of code creates a temporary file on your machine to house the zip file. The second line of code downloads the zip file into the temporary file. The third line unzips the zip file into the current working directory. You should see the six files that constitute the shapefile:</p>
<pre><code>[1] &quot;Income_schooling.dbf&quot; &quot;Income_schooling.prj&quot; &quot;Income_schooling.sbn&quot;
[4] &quot;Income_schooling.sbx&quot; &quot;Income_schooling.shp&quot; &quot;Income_schooling.shx&quot;
[7] &quot;Income_schooling.zip&quot;</code></pre>
<p>The following chunk of code will download a <a href="http://www.geopackage.org/">GeoPackage</a> file into the current working directory. Note that the file is not zipped thus eliminating any need to unzip (unlike a shapefile, a GeoPackage data file is self-contained).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/TX.gpkg&quot;</span>, <span class="dt">destfile =</span> <span class="st">&quot;./TX.gpkg&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;wb&quot;</span>)</code></pre></div>
<div id="reading-a-shapefile-with-rgdal" class="section level3">
<h3><span class="header-section-number">14.2.3</span> Reading a shapefile with <code>rgdal</code></h3>
<p>There are two different ways one can load a shapefile into R: using the <code>rgdal</code> package and using the <code>maptools</code> package. The difference between both methods is that the <code>rgdal</code> option loads the coordinate system (CS) information (if present in the shapefile) while <code>maptools</code> does not.</p>
<p>The function <code>readOGR()</code> from <code>rgdal</code> is used to load the shapefile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
s1 &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;Income_schooling&quot;</span>)</code></pre></div>
<pre><code>OGR data source with driver: ESRI Shapefile 
Source: &quot;.&quot;, layer: &quot;Income_schooling&quot;
with 16 features
It has 5 fields</code></pre>
<p>The <code>&quot;.&quot;</code> parameter tells R to look for the shapefile in the current working directory, the second parameter tells R the name of the shapefile to open. Note that you <strong>must not</strong> add a file extension to the name as this will generate an error message.</p>
<p>Let’s check the contents of this shapefile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s1)</code></pre></div>
<pre><code>Object of class SpatialPolygonsDataFrame
Coordinates:
        min       max
x  336337.7  660529.1
y 4772272.3 5255569.2
Is projected: TRUE 
proj4string :
[+proj=utm +zone=19 +datum=NAD83 +units=m +no_defs +ellps=GRS80
+towgs84=0,0,0]
Data attributes:
           NAME        Income         NoSchool          NoSchoolSE       
 Androscoggin: 1   Min.   :20015   Min.   :0.002390   Min.   :0.0006832  
 Aroostook   : 1   1st Qu.:21631   1st Qu.:0.004907   1st Qu.:0.0009130  
 Cumberland  : 1   Median :23788   Median :0.005252   Median :0.0010281  
 Franklin    : 1   Mean   :24716   Mean   :0.005778   Mean   :0.0011658  
 Hancock     : 1   3rd Qu.:27897   3rd Qu.:0.006603   3rd Qu.:0.0013404  
 Kennebec    : 1   Max.   :32549   Max.   :0.013387   Max.   :0.0021290  
 (Other)     :10                                                         
    IncomeSE    
 Min.   :242.4  
 1st Qu.:342.6  
 Median :455.8  
 Mean   :458.8  
 3rd Qu.:551.5  
 Max.   :724.2  
                </code></pre>
<p>Note the coordinate information under the <code>proj4string :</code> heading. It suggests that the CS is a UTM projection for zone 19 (north) and an NAD83 datum.</p>
</div>
<div id="reading-a-shapefile-with-maptools" class="section level3">
<h3><span class="header-section-number">14.2.4</span> Reading a shapefile with <code class="unnumbered">maptools</code></h3>
<p>Here, we’ll use <code>readShapeSpatial()</code> from <code>maptools</code> to load the shapefile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
s2 &lt;-<span class="st"> </span><span class="kw">readShapeSpatial</span>(<span class="st">&quot;Income_schooling&quot;</span>)</code></pre></div>
<p>Let’s check the contents of this shapefile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s2)</code></pre></div>
<pre><code>Object of class SpatialPolygonsDataFrame
Coordinates:
        min       max
x  336337.7  660529.1
y 4772272.3 5255569.2
Is projected: NA 
proj4string : [NA]
Data attributes:
           NAME        Income         NoSchool          NoSchoolSE       
 Androscoggin: 1   Min.   :20015   Min.   :0.002390   Min.   :0.0006832  
 Aroostook   : 1   1st Qu.:21631   1st Qu.:0.004907   1st Qu.:0.0009130  
 Cumberland  : 1   Median :23788   Median :0.005252   Median :0.0010281  
 Franklin    : 1   Mean   :24716   Mean   :0.005778   Mean   :0.0011658  
 Hancock     : 1   3rd Qu.:27897   3rd Qu.:0.006603   3rd Qu.:0.0013404  
 Kennebec    : 1   Max.   :32549   Max.   :0.013387   Max.   :0.0021290  
 (Other)     :10                                                         
    IncomeSE    
 Min.   :242.4  
 1st Qu.:342.6  
 Median :455.8  
 Mean   :458.8  
 3rd Qu.:551.5  
 Max.   :724.2  
                </code></pre>
<p><code>s2</code>’s summary output is nearly identical to that of <code>s1</code> except for the missing CS (the summary indicates that <code>Is projected: NA</code>, i.e. that there is no projection information).</p>
</div>
<div id="reading-a-geopackage" class="section level3">
<h3><span class="header-section-number">14.2.5</span> Reading a GeoPackage</h3>
<p>A GeoPackage can be read with the <code>rgdal</code> package. A GeoPackage is a spatial database that can store more than one layer. This requires knowledge of the layer name which may be different from database filename. You can extract the layer name(s) from a GeoPackage as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
<span class="kw">ogrListLayers</span>(<span class="st">&quot;TX.gpkg&quot;</span>)[<span class="dv">1</span>]</code></pre></div>
<pre><code>[1] &quot;TX&quot;</code></pre>
<p>The <code>TX.gpkg</code> file has a single layer called <code>TX</code>. To extract the layer <code>TX</code> into a new spatial object called <code>s3</code>, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s3 &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;TX.gpkg&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;TX&quot;</span>)</code></pre></div>
<pre><code>OGR data source with driver: GPKG 
Source: &quot;TX.gpkg&quot;, layer: &quot;TX&quot;
with 1 features
It has 49 fields</code></pre>
</div>
</div>
<div id="reading-gis-raster-files" class="section level2 unnumbered">
<h2>Reading GIS raster files</h2>
<p>First, we’ll load a sample raster file into your current working directory (you might want to create a temporary folder for this exercise and set it as the working directory via the <strong>Session &gt;&gt; Set Working Directory &gt;&gt; Choose Directory</strong> pull-down menu from the RStudio interface). The raster file will be in an ERDAS Imagine format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/elevation.img&quot;</span>, 
              <span class="dt">destfile =</span> <span class="st">&quot;./elevation.img&quot;</span>, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)</code></pre></div>
<p>Raster files can be read with <code>rgdal</code>’s <code>readGDAL()</code> function or with <code>raster</code>’s <code>raster()</code> function. They differ in the output formats and in the way the data are managed in an R session–<code>readGDAL</code> will load the raster as a <code>SpatialGridDataFrame</code> object whereas <code>raster</code> will load the data as a <code>raster*</code> object and <code>raster</code> will not load the entire raster into memory whereas <code>readGDAL</code> will making <code>raster</code>’s approach attractive if large rasters are to be worked with. If you wish to load all data from a <code>raster</code> object in R memory, wrap the raster object with<code>readAll</code> as in <code>r1 &lt;- readAll(r)</code>.</p>
<p>In the following example, we’ll load the raster as a <code>raster*</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)
r1 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;elevation.img&quot;</span>)</code></pre></div>
<p>To view the contents of the newly created <code>r1</code> raster object, type its name at the command line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r1</code></pre></div>
<pre><code>class       : RasterLayer 
dimensions  : 540, 1080, 583200  (nrow, ncol, ncell)
resolution  : 0.3333333, 0.3333333  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
data source : D:\mgimond\GitHub\Spatial\elevation.img 
names       : elevation 
values      : 0, 6821  (min, max)</code></pre>
<p>You’ll note that the object is of class <code>RasterLayer</code>. You’ll also note that the coordinate system information stored in the original raster has been carried over into the <code>r1</code> object.</p>
<p>The <code>raster</code> function will recognize many difference raster formats including GeoTIFF and jpg.</p>
</div>
<div id="dissecting-the-file-summary" class="section level2 unnumbered">
<h2>Dissecting the file summary</h2>
<p>Let’s explore the contents of <code>s1</code>’s summary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s1)</code></pre></div>
<pre><code>Object of class SpatialPolygonsDataFrame
Coordinates:
        min       max
x  336337.7  660529.1
y 4772272.3 5255569.2
Is projected: TRUE 
proj4string :
[+proj=utm +zone=19 +datum=NAD83 +units=m +no_defs +ellps=GRS80
+towgs84=0,0,0]
Data attributes:
           NAME        Income         NoSchool          NoSchoolSE       
 Androscoggin: 1   Min.   :20015   Min.   :0.002390   Min.   :0.0006832  
 Aroostook   : 1   1st Qu.:21631   1st Qu.:0.004907   1st Qu.:0.0009130  
 Cumberland  : 1   Median :23788   Median :0.005252   Median :0.0010281  
 Franklin    : 1   Mean   :24716   Mean   :0.005778   Mean   :0.0011658  
 Hancock     : 1   3rd Qu.:27897   3rd Qu.:0.006603   3rd Qu.:0.0013404  
 Kennebec    : 1   Max.   :32549   Max.   :0.013387   Max.   :0.0021290  
 (Other)     :10                                                         
    IncomeSE    
 Min.   :242.4  
 1st Qu.:342.6  
 Median :455.8  
 Mean   :458.8  
 3rd Qu.:551.5  
 Max.   :724.2  
                </code></pre>
<p>The first line of output gives us the spatial object type, <code>SpatialPolygonsDataFrame</code>. It suggests that the shapefile is a polygon layer and that it has an attributes tables (hence the segment <code>DataFrame</code> in the object name). If this were a polyline layer the object type would be <code>SpatialLinesDataFrame</code> and if it were a point layer the object type would be <code>SpatialPointsDataFrame</code>.</p>
<p>The next few lines of output give us the bounding extent of the layer in the layer’s coordinate system units.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Coordinates:
<span class="st">        </span>min       max
x  <span class="fl">336337.7</span>  <span class="fl">660529.1</span>
y <span class="fl">4772272.3</span> <span class="fl">5255569.2</span></code></pre></div>
<p>The three lines that follow give us the projection information. Note, once again, that this information is absent if you loaded the data via <code>maptools</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Is projected:<span class="st"> </span><span class="ot">TRUE</span> 
proj4string :
[+proj=utm +zone=<span class="dv">19</span> +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]</code></pre></div>
<p>What remains of the output is a summary of each column in the attributes table. There are 5 columns named .</p>
<p>You can also extract the column names via the <code>names</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(s1)</code></pre></div>
<pre><code>[1] &quot;NAME&quot;       &quot;Income&quot;     &quot;NoSchool&quot;   &quot;NoSchoolSE&quot; &quot;IncomeSE&quot;  </code></pre>
<p>If you want to extract the contents of the attributes tables, use the <code>data.frame</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data.frame</span>(s1)</code></pre></div>
<pre><code>           NAME Income   NoSchool  NoSchoolSE IncomeSE
0     Aroostook  21024 0.01338720 0.001406960  250.909
1      Somerset  21025 0.00521153 0.001150020  390.909
2   Piscataquis  21292 0.00633830 0.002128960  724.242
3     Penobscot  23307 0.00684534 0.001025450  242.424
4    Washington  20015 0.00478188 0.000966036  327.273
5      Franklin  21744 0.00508507 0.001641740  530.909
6        Oxford  21885 0.00700822 0.001318160  536.970
7         Waldo  23020 0.00498141 0.000918837  450.909
8      Kennebec  25652 0.00570358 0.000917087  360.000
9  Androscoggin  24268 0.00830953 0.001178660  460.606
10      Hancock  28071 0.00238996 0.000784584  585.455
11         Knox  27141 0.00652269 0.001863920  684.849
12      Lincoln  27839 0.00278315 0.001030800  571.515
13   Cumberland  32549 0.00494917 0.000683236  346.061
14    Sagadahoc  28122 0.00285524 0.000900782  544.849
15         York  28496 0.00529228 0.000737195  332.121</code></pre>
</div>
<div id="mapping-spatial-data" class="section level2 unnumbered">
<h2>Mapping spatial data</h2>
<p>There are many ways one can plot spatial features in R. We’ll explore two approaches: one using <code>sp</code>’s <code>spplot</code>, the second using the <code>tmap</code> package.</p>
<div id="mapping-with-spplot" class="section level3">
<h3><span class="header-section-number">14.2.6</span> Mapping with <code class="unnumbered">spplot</code></h3>
<p><code>spplot</code> is a base plotting function that is part of the <code>sp</code> package. Note that <code>sp</code> underlies many other packages including <code>maptools</code> and <code>rgdal</code>.</p>
<p>To simply plot the <code>Income</code> attribute, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(s1, <span class="dt">z=</span><span class="st">&quot;Income&quot;</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-18-1.png" width="350" style="display: block; margin: auto;" /></p>
<p>The resulting map is referred to as a choropleth map (choro = area and pleth = value) where some value (an enumeration of population in this working example) is aggregated over a defined area (e.g.counties) and displayed using different colors.</p>
<p>We can control how the attribute values are binned and which colors to assign to each bin. We will use the function <code>classIntervals</code> to generate the breaks following a quantile scheme. The <code>classIntervals</code>’s minimum and maximum values will be the range of values from the <code>Income</code> attribute. This poses a problem since the <code>spplot</code> function will interpret that maximum value as not being inclusive which will result in the polygon having the maximum attribute value not being assigned a color. To remedy this, we will pad the maximum value with the value of <code>0.1</code>.</p>
<p>We will also use the <code>RColorBrewer</code> package to generate the different color swatches: In our working example, we will generate four different shades of green. The code chunk and resulting map follow:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(classInt)
<span class="kw">library</span>(RColorBrewer)

<span class="co"># Generate breaks</span>
brks &lt;-<span class="st">  </span><span class="kw">classIntervals</span>(s1$Income, <span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">style =</span> <span class="st">&quot;quantile&quot;</span>)$brks
brks[<span class="kw">length</span>(brks)] &lt;-<span class="st"> </span>brks[<span class="kw">length</span>(brks)] +<span class="st"> </span><span class="dv">1</span>

<span class="co"># Define color swatches</span>
pal  &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">4</span>, <span class="st">&quot;Greens&quot;</span>)

<span class="co"># Generate the map</span>
<span class="kw">spplot</span>(s1, <span class="dt">z=</span><span class="st">&quot;Income&quot;</span>, <span class="dt">at =</span> brks, <span class="dt">col.regions=</span>pal)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-19-1.png" width="350" style="display: block; margin: auto;" /></p>
<p>Note how we are able to extract the <code>Income</code> column via <code>s1$Income</code> which is passed to the <code>classIntervals</code> function (which, in turn, uses these values to compute the breaks). The breaks are stored in the object <code>brks</code>; its contents are 20015.0, 21631.0, 23787.5, 27897.0, 32550.0.</p>
<p>A nice feature of <code>spplot</code> is its legend: instead of generating discrete color swatches (with associated value ranges) <code>ssplot</code> generates contiguous color swatches along a scale which provides us with not only information on the ranges covered by the colors but a visual on the distribution of these bins.</p>
</div>
<div id="mapping-with-tmap" class="section level3">
<h3><span class="header-section-number">14.2.7</span> Mapping with <code class="unnumbered">tmap</code></h3>
<p>The <code>tmap</code> package is designed to map thematic data. The following chunk recreates the map generated with <code>spplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tmap)
<span class="kw">qtm</span>(s1, <span class="dt">fill=</span><span class="st">&quot;Income&quot;</span>, <span class="dt">fill.style=</span><span class="st">&quot;quantile&quot;</span>, 
    <span class="dt">fill.n=</span><span class="dv">8</span> ,<span class="dt">fill.palette=</span><span class="st">&quot;Greens&quot;</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>fill.style</code> parameter defines the binning scheme. Here we choose a quantile scheme. Other options include <code>equal</code> (equal interval), <code>jenks</code> (same scheme ArcMap defaults to), <code>sd</code> (breaks the data into standard deviations), <code>kmeans</code> (based on the kmeans method), and <code>pretty</code> to name a few. If you want to manually define your breaks, you can pass the option <code>fixed</code> to the <code>fill.style</code> parameter then pass the desired breaks to the <code>breaks</code> parameter. For example, to break the data into 3 bins–<code>under $23,000</code>, <code>$23,000 to $27,000</code> and <code>$27,000 and greater</code>– modify the above chunk as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tmap)
<span class="kw">qtm</span>(s1, <span class="dt">fill=</span><span class="st">&quot;Income&quot;</span>, <span class="dt">fill.style=</span><span class="st">&quot;fixed&quot;</span>, 
    <span class="dt">fill.breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23000</span> ,<span class="dv">27000</span>,<span class="dv">100000</span> ), 
    <span class="dt">fill.labels=</span><span class="kw">c</span>(<span class="st">&quot;under $23,000&quot;</span>, <span class="st">&quot;$23,000 to $27,000&quot;</span>, <span class="st">&quot;above $27,000&quot;</span>),
    <span class="dt">fill.palette=</span><span class="st">&quot;Greens&quot;</span>,
    <span class="dt">legend.text.size =</span> <span class="fl">0.5</span>,
    <span class="dt">layout.legend.position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If a more complex map is desired, the plotting functions can be broken down into elements (similar to <code>ggplot2</code>’s plotting elements). The last block of code can be modified as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(s1) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Income&quot;</span>, <span class="dt">style=</span><span class="st">&quot;fixed&quot;</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23000</span> ,<span class="dv">27000</span>,<span class="dv">100000</span> ),
          <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;under $23,000&quot;</span>, <span class="st">&quot;$23,000 to $27,000&quot;</span>, <span class="st">&quot;above $27,000&quot;</span>),
          <span class="dt">palette=</span><span class="st">&quot;Greens&quot;</span>)  +
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="st">&quot;grey&quot;</span>) +
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside =</span> <span class="ot">TRUE</span>, <span class="dt">text.size =</span> .<span class="dv">8</span>) +
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here, we move the legend element to the right of the map data frame and we suppress the drawing of the map border.</p>
</div>
<div id="mapping-rasters-with-tmap" class="section level3">
<h3><span class="header-section-number">14.2.8</span> Mapping rasters with <code class="unnumbered">tmap</code></h3>
<p>To generate a quick map, simply use the <code>qtm</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qtm</span>(r1)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>The next chunk of code overlays the raster with a vector layer and limits the extent to the northeastern US. To maximize the use of colors, elevation breaks are manually defined.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(r1, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">50</span>), <span class="dt">xlim=</span><span class="kw">c</span>(-<span class="dv">100</span>,-<span class="dv">50</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>,<span class="dv">400</span>,<span class="dv">500</span>,<span class="dv">750</span>,<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>,<span class="dv">3000</span>,<span class="dv">4000</span>)) +
<span class="st">  </span><span class="kw">tm_shape</span>(s1) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Income&quot;</span>, <span class="dt">style=</span><span class="st">&quot;fixed&quot;</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23000</span> ,<span class="dv">27000</span>,<span class="dv">100000</span> ),
          <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;under $23,000&quot;</span>, <span class="st">&quot;$23,000 to $27,000&quot;</span>, <span class="st">&quot;above $27,000&quot;</span>),
          <span class="dt">palette=</span><span class="st">&quot;Greens&quot;</span>)  +
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="st">&quot;grey&quot;</span>) +
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside =</span> <span class="ot">TRUE</span>, <span class="dt">text.size =</span> .<span class="dv">8</span>) +
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To learn more about the tmap package, check out the <a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-nutshell.html">package vignette</a> and the package author’s <a href="http://von-tijn.nl/tijn/research/presentations/tmap_user2015.pdf">presentation</a>.</p>
</div>
</div>
<div id="joining-tables-to-spatial-features" class="section level2 unnumbered">
<h2>Joining tables to spatial features</h2>
<p>First, we’ll download a comma delimited table (aka a CSV file). The table consists of population count and land/water surface area for each county in the state of Maine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/ME2010_pop.csv&quot;</span>)</code></pre></div>
<p>Next, we’ll make use of <code>dplyr</code>’s <code>left_join</code> function to join the table to the spatial object <code>s1</code> by county name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
s1@data &lt;-<span class="st"> </span><span class="kw">left_join</span>(s1@data, df, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;NAME&quot;</span> =<span class="st"> &quot;County&quot;</span>))</code></pre></div>
<p>The spatial object <code>s1</code> consists of many components including the attributes table. Accessing each component requires appending the object name with <code>@</code>. In our case, we are accessing the attributes table (stored in the <code>data</code> component) via <code>s1@data</code>. In essence, the above code is joining the data table <code>df</code> to the attributes table <code>s1@data</code> and overwriting the existing attributes table (with the join) in the process. The function is also provided with a join <em>key</em> that dictates which columns from each table are to be used to match the records. Here, we are matching <code>s1</code>’s <code>NAME</code> column with <code>df</code>’s <code>County</code> column (both store the county names).</p>
<div class="warning">
<p>
For a join to be successful, all record elements must match letter for letter–this includes case! For example <code>Kennebec</code> and <code>kennebec</code> will not match since one has an upper case <code>K</code> while the other does not.
</p>
</div>
<p>Attribute tables can be manipulated just like any other regular table in R. For example, to compute population density from the population field and the land area field, type the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s1$Pop_dens =<span class="st"> </span>s1$Population /<span class="st"> </span>s1$Land</code></pre></div>
<p>The <code>$</code> symbol accesses the field names <code>Population</code> and <code>Land</code>. The new field <code>Pop_dens</code> is now added to the <code>s1</code> attributes table. Next, we’ll map the population density values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(s1) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Pop_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>,  <span class="dt">palette=</span><span class="st">&quot;Reds&quot;</span>,
          <span class="dt">title=</span><span class="st">&quot;Population density </span><span class="ch">\n</span><span class="st">(per square mile)&quot;</span>) +
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="st">&quot;white&quot;</span>) +
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside =</span> <span class="ot">TRUE</span>, <span class="dt">text.size =</span> .<span class="dv">8</span>) +
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="converting-xy-data-to-point-objects" class="section level2 unnumbered">
<h2>Converting XY data to point objects</h2>
<p>Let’s create a new data table with latitude and longitude values for nine major cities in the state of Maine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(-<span class="fl">68.783</span>, -<span class="fl">69.6458</span>, -<span class="fl">69.7653</span>, -<span class="fl">69.9536</span>, 
                          -<span class="fl">70.7733</span>, -<span class="fl">70.4462</span>, -<span class="fl">70.4449</span>, -<span class="fl">70.1924</span>, -<span class="fl">70.2691</span>), 
                  <span class="dt">lat =</span> <span class="kw">c</span>(<span class="fl">44.8109</span>, <span class="fl">44.5521</span>, <span class="fl">44.3235</span>, <span class="fl">43.913</span>, 
                          <span class="fl">43.4399</span>, <span class="fl">43.4741</span>, <span class="fl">43.5104</span>, <span class="fl">44.0975</span>, <span class="fl">43.6651</span> ), 
                  <span class="dt">Name =</span> <span class="kw">c</span>(<span class="st">&quot;Bangor&quot;</span>, <span class="st">&quot;Waterville&quot;</span>, <span class="st">&quot;Augusta&quot;</span>, <span class="st">&quot;Brunswick&quot;</span>, 
                           <span class="st">&quot;Sanford&quot;</span>, <span class="st">&quot;Biddeford&quot;</span>, <span class="st">&quot;Saco&quot;</span>, <span class="st">&quot;Lewiston&quot;</span>, <span class="st">&quot;Portland&quot;</span>) )</code></pre></div>
<p>Next, we’ll create a spatial object (a <code>SpatialPointsDataFrame</code> to be more precise) from the regular data table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pt &lt;-<span class="st"> </span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> df2[,<span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)], <span class="dt">data =</span> df2,
                             <span class="dt">proj4string =</span> <span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>))</code></pre></div>
<p>The <code>coords</code> parameter is given the latitude and longitude value columns–values used to locate the points associated with each record. The <code>proj4string</code> parameter defines the coordinate systems associated with the lat/long values–a WGS 1984 Geographic Coordinate System in our example.</p>
<p>Let’s check that <code>pt</code> is indeed a spatial object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(pt)     </code></pre></div>
<pre><code>Object of class SpatialPointsDataFrame
Coordinates:
         min      max
lon -70.7733 -68.7830
lat  43.4399  44.8109
Is projected: FALSE 
proj4string :
[+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
Number of points: 9
Data attributes:
      lon              lat               Name  
 Min.   :-70.77   Min.   :43.44   Augusta  :1  
 1st Qu.:-70.44   1st Qu.:43.51   Bangor   :1  
 Median :-70.19   Median :43.91   Biddeford:1  
 Mean   :-70.03   Mean   :43.98   Brunswick:1  
 3rd Qu.:-69.77   3rd Qu.:44.32   Lewiston :1  
 Max.   :-68.78   Max.   :44.81   Portland :1  
                                  (Other)  :3  </code></pre>
<p>Note the object class <code>SpatialPointsDataFrame</code>. Also note that the dataframe contents were also carried over into the attributes table (here we had just one attribute, <code>Name</code>, other than <code>lon</code> and <code>lat</code>).</p>
<p>The next chunk of code plots the point layer on top of the population density thematic map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(s1) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Pop_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>,  <span class="dt">palette=</span><span class="st">&quot;Reds&quot;</span>,
          <span class="dt">title=</span><span class="st">&quot;Population density </span><span class="ch">\n</span><span class="st">(per square mile)&quot;</span>) +
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="st">&quot;white&quot;</span>) +
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside =</span> <span class="ot">TRUE</span>, <span class="dt">text.size =</span> .<span class="dv">8</span>) +
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>,
            <span class="dt">inner.margins =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.01</span>)) +
<span class="kw">tm_shape</span>(pt) +
<span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">size=</span>.<span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">border.col=</span><span class="st">&quot;black&quot;</span>) +
<span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;Name&quot;</span>, <span class="dt">auto.placement =</span> <span class="ot">TRUE</span>, <span class="dt">shadow=</span><span class="ot">TRUE</span>, <span class="dt">size=</span><span class="fl">0.8</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="geocoding-street-addresses" class="section level2 unnumbered">
<h2>Geocoding street addresses</h2>
<p>The package <code>ggmap</code> offers a geocoding function called <code>mutate_geocode</code> which will take a table with physical addresses and create a new table with latitude and longitude values for those addresses. The new table also contains all other columns of the input table. The function makes use of Google Maps’ API.</p>
<p>Let’s first create a new data table with addresses for a few liberal arts colleges in the state of Maine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Address =</span> <span class="kw">c</span>(<span class="st">&quot;4000 mayflower Hill, Waterville, Maine&quot;</span>, 
                     <span class="st">&quot;2 Andrews Rd, Lewiston, ME 04240&quot;</span>,
                     <span class="st">&quot;255 Maine St, Brunswick, ME 04011&quot;</span>,
                     <span class="st">&quot;90 Quaker Hill Rd, Unity, ME 04988&quot;</span>,
                     <span class="st">&quot;105 Eden St, Bar Harbor, ME 04609&quot;</span>),
         <span class="dt">College =</span> <span class="kw">c</span>(<span class="st">&quot;Colby&quot;</span>, <span class="st">&quot;Bates&quot;</span>, <span class="st">&quot;Bowdoin&quot;</span>, <span class="st">&quot;Unity&quot;</span>, <span class="st">&quot;CoA&quot;</span>),
         <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Next, we’ll geocode the addresses and save the output to a new data table called <code>df3.geo</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)
df3.geo &lt;-<span class="st"> </span><span class="kw">mutate_geocode</span>(df3, <span class="dt">location=</span>Address, <span class="dt">output=</span><span class="st">&quot;latlona&quot;</span> )</code></pre></div>
<p>The <code>location</code> parameter is assigned the column with the addresses. The <code>output</code> parameter is given instructions on what to output. Here, the option <code>latlona</code> instructs R to output both the lat/lon values as well as all other attributes. It also adds another column called <code>address</code> with Google’s nearest address match–not all addresses are necessarily matched exactly requiring Google to propose the closest match.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df3.geo</code></pre></div>
<pre><code>                                 Address College       lon      lat
1 4000 mayflower Hill, Waterville, Maine   Colby -69.65321 44.55605
2       2 Andrews Rd, Lewiston, ME 04240   Bates -70.20420 44.10675
3      255 Maine St, Brunswick, ME 04011 Bowdoin -69.96524 43.90701
4     90 Quaker Hill Rd, Unity, ME 04988   Unity -69.33084 44.60335
5      105 Eden St, Bar Harbor, ME 04609     CoA -68.22182 44.39536
                                       address
1 mayflower hill dr, waterville, me 04901, usa
2        2 andrews rd, lewiston, me 04240, usa
3       255 maine st, brunswick, me 04011, usa
4      90 quaker hill rd, unity, me 04988, usa
5       105 eden st, bar harbor, me 04609, usa</code></pre>
<p>In our little example, all addresses are matched exactly except Colby which is assigned <code>mayflower hill dr</code> without a number.</p>
<div class="warning">
<p>
Note that the Google Maps API sets the limit to 2500 queries a day. To check how many queries you have left in your session, use <code>geocodeQueryCheck</code>.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">geocodeQueryCheck</span>()</code></pre></div>
<pre><code>2495 geocoding queries remaining.</code></pre>
<p>Note that <code>df2.geo</code> is not a spatial object. It needs to be converted to one if it is to be used in generating a map output. The lat/lon values are assumed to be recorded in a WGS84 geographic coordinate system.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pt2 &lt;-<span class="st"> </span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> df3.geo[,<span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)], <span class="dt">data =</span> df3.geo,
                             <span class="dt">proj4string =</span> <span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>))</code></pre></div>
<p>Finally, we’ll add the points to an existing thematic map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(s1) +<span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;Pop_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>,  <span class="dt">palette=</span><span class="st">&quot;Reds&quot;</span>,
          <span class="dt">title=</span><span class="st">&quot;Population density </span><span class="ch">\n</span><span class="st">(per square mile)&quot;</span>) +
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="st">&quot;white&quot;</span>) +
<span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside =</span> <span class="ot">TRUE</span>, <span class="dt">text.size =</span> .<span class="dv">8</span>) +
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>,
            <span class="dt">inner.margins =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">0</span>, <span class="fl">0.01</span>)) +
<span class="kw">tm_shape</span>(pt2) +
<span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">size=</span>.<span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">border.col=</span><span class="st">&quot;black&quot;</span>) +
<span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;College&quot;</span>, <span class="dt">auto.placement =</span> <span class="ot">TRUE</span>, <span class="dt">shadow=</span><span class="ot">TRUE</span>, <span class="dt">size=</span><span class="fl">0.8</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you wish to use Google Maps as a backdrop, you can map the points with <code>ggmap</code>’s <code>qmplot</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qmplot</span>(lon, lat, <span class="dt">data=</span>df3.geo, <span class="dt">source=</span><span class="st">&quot;osm&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label=</span>College), <span class="dt">hjust =</span> <span class="st">&quot;inward&quot;</span>, <span class="dt">vjust=</span><span class="st">&quot;inward&quot;</span>)</code></pre></div>
<p><img src="A1-Data-Manipulation_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="exporting-to-a-shapefile" class="section level2 unnumbered">
<h2>Exporting to a shapefile</h2>
<p>Both <code>rgdal</code> and <code>maptools</code> have functions to export spatial objects to shapefiles, but only <code>rgdal</code> will export the coordinate systems (if present) with the shapefile. The following chunk of code demonstrates the exports of two spatial objects created earlier in this exercise: <code>s1</code> (a <code>SpatialPolygonsDataFrame</code> object) and <code>pt2</code> (a <code>SpatialPointsDataFrame</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)

<span class="co"># Save polygon layer to shapefile</span>
<span class="kw">writeOGR</span>(s1, <span class="dt">dsn=</span><span class="st">&quot;.&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;Counties&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span> )

<span class="co"># Save point layer to shapefile</span>
<span class="kw">writeOGR</span>(pt2, <span class="dt">dsn=</span><span class="st">&quot;.&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;Colleges&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span> )</code></pre></div>
<p>The <code>layer=&quot;Colleges&quot;</code> parameter defines the file names (note that the file extension is not specified since it will be automatically added based on the output format) and the <code>driver</code> parameter specifies the output file format.</p>
</div>
<div id="exporting-to-a-geopackage" class="section level2 unnumbered">
<h2>Exporting to a GeoPackage</h2>
<p><code>rgdal</code>’s <code>GPKG</code> driver is used to export to a GeoPackage format. The syntax is slightly different from that used to export to a shapefile in that the database name must be specified as well as the layer name. For example, the following chunk of code exports the <code>Counties</code> layer to a database named <code>geo.gpkg</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)

<span class="co"># Save polygon layer to shapefile</span>
<span class="kw">writeOGR</span>(s1, <span class="dt">dsn=</span><span class="st">&quot;geo.gpkg&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;Counties&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;GPKG&quot;</span> )</code></pre></div>
</div>
<div id="exporting-to-a-raster-file-format" class="section level2 unnumbered">
<h2>Exporting to a raster file format</h2>
<p>You may use <code>raster</code>’s <code>writeRaster</code> function to export rasters to external raster formats. For example, to export to a GeoTIFF raster:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
<span class="kw">writeRaster</span>(r1, <span class="dt">filename=</span><span class="st">&quot;elev&quot;</span>, <span class="dt">format=</span><span class="st">&quot;GTiff&quot;</span> )</code></pre></div>
<p>To export to an ERDAS Imagine file format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
<span class="kw">writeRaster</span>(r1, <span class="dt">filename=</span><span class="st">&quot;elev&quot;</span>, <span class="dt">format=</span><span class="st">&quot;HFA&quot;</span> )</code></pre></div>
<p>To list all available output raster file formats, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeFormats</span>()</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-interpolation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coordinate-systems-in-r.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
